import{_ as i,c as a,a as n,o as l}from"./app-C7T5jqfQ.js";const e={};function p(t,s){return l(),a("div",null,s[0]||(s[0]=[n(`<blockquote><p><em>应用程序资源文件</em> 指定应用程序使用的资源以及应用程序的启动方式。 对于系统中的每个应用程序 <code>Application</code>，必须始终存在一个名为 <code>Application.app</code> 的应用程序资源文件。</p><p>当加载/启动应用程序时，该文件由应用程序控制器读取。 它还被 <code>systools</code> 中的函数使用，例如在生成启动脚本时</p></blockquote><h3 id="文件语法" tabindex="-1"><a class="header-anchor" href="#文件语法"><span>文件语法</span></a></h3><blockquote><p>应用程序资源文件应命名为 <code>Application.app</code>，其中 <code>Application</code> 是应用程序名称。 该文件应位于应用程序的 <code>ebin</code> 目录中。</p><p>该文件必须包含单个 Erlang 项，称为<em>应用程序规范</em></p></blockquote><div class="language-erlang line-numbers-mode" data-highlighter="shiki" data-ext="erlang" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">application</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Application</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [{</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">description</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  Description</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">           Id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">vsn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          Vsn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">modules</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">      Modules</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">maxP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">         MaxP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">maxT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">         MaxT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">registered</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">   Names</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">included_applications</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Apps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">optional_applications</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Apps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">applications</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Apps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">env</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          Env</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">mod</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          Start</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">start_phases</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Phases</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">runtime_dependencies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> RTDeps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}]}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">             Value</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                Default</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">             -----</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                -------</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Application</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  atom</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">               -</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Description</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  string</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">             &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Id</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">           string</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">             &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Vsn</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          string</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">             &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Modules</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">      [</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">             []</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">MaxP</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">         int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">                infinity</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">MaxT</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">         int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">                infinity</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Names</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">        [</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">               []</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Apps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">         [</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">App</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">                []</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Env</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">          [{</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Par</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Val</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">          []</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Start</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">        {</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">StartArgs</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">   []</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Phases</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">       [{</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Phase</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">PhaseArgs</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}]</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  undefined</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">RTDeps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">       [</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ApplicationVersion</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Module</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> App</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Par</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Phase</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> atom</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Val</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> StartArgs</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PhaseArgs</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> term</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ApplicationVersion</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> string</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong><code>Application</code></strong> - 应用程序名称。</li></ul><p>对于应用程序控制器，所有键都是可选的。 对于任何省略的键，都使用相应的默认值。</p><p><code>systools</code> 中的函数需要更多信息。如果使用它们，则以下键是强制性的</p><ul><li><code>description</code></li><li><code>vsn</code></li><li><code>modules</code></li><li><code>registered</code></li><li><code>applications</code></li></ul><p>其他键将被 <code>systools</code> 忽略。</p><ul><li><p><strong><code>description</code></strong> - 应用程序的单行描述。</p></li><li><p><strong><code>id</code></strong> - 产品标识或类似信息。</p></li><li><p><strong><code>vsn</code></strong> - 应用程序的版本。通常最好坚持使用 <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code> 或类似格式的方案。当我们开始使用工具来帮助进行升级和降级时，该字符串将用于标识应用程序的版本。</p></li><li><p><strong><code>modules</code></strong> - 此应用程序引入的所有模块。<code>systools</code> 在生成启动脚本和 tar 文件时使用此列表。一个模块只能在一个应用程序中定义。</p></li><li><p><strong><code>maxP</code></strong> - <em>已弃用 - 将被忽略</em></p><p>应用程序中允许的最大进程数。</p></li><li><p><strong><code>maxT</code></strong> - 允许应用程序运行的最大时间（以毫秒为单位）。 超过指定时间后，应用程序会自动终止。默认值为 <code>infinity</code></p></li><li><p><strong><code>registered</code></strong> - 在此应用程序中启动的所有已注册进程的名称。<code>systools</code> 使用此列表来检测不同应用程序之间的名称冲突。</p></li><li><p><strong><code>included_applications</code></strong> - 此应用程序包含的所有应用程序。 当此应用程序启动时，所有包含的应用程序都会被应用程序控制器自动加载，但不会启动。 假设包含的应用程序的顶层 supervisor 由此应用程序的 supervisor 启动。</p></li><li><p><strong><code>applications</code></strong> - 必须在此应用程序之前启动的所有应用程序。 如果一个应用程序也列在 <code>optional_applications</code> 中，则该应用程序不是必须存在的（但如果存在，则保证它也会在此应用程序之前启动）。</p><p><code>systools</code> 使用此列表来生成正确的启动脚本。 默认为空列表，但请注意，<strong>所有应用程序都依赖于（至少）Kernel 和 STDLIB</strong>。</p></li><li><p><strong><code>optional_applications</code></strong> - 可选的 <code>applications</code> 列表。 请注意，如果您希望在可选依赖项可用时始终在其之前自动启动当前应用程序，则它必须同时列在 <code>applications</code> 和 <code>optional_applications</code> 中。</p></li><li><p><strong><code>env</code></strong> - 应用程序使用的配置参数。 配置参数的值通过调用 <code>application:get_env/1,2</code> 检索。 第一个将在调用时尝试在当前所在的应用程序的应用程序文件中找到该值，第二个允许你指定特定应用程序。这些内容可以根据需要被覆盖（在引导时或使用 <code>application:set_env/3-4</code>）。</p></li><li><p><strong><code>mod</code></strong> - 指定应用程序回调模块和启动参数，请参阅 <a href="https://erlang.org.cn/doc/apps/kernel/application" target="_blank" rel="noopener noreferrer"><code>application</code></a>。</p><p>对于实现为 supervisor 树的应用程序，键 <code>mod</code> 是必需的，这告诉 OTP 在启动你的应用程序时，应调用 <code>CallbackMod:start(normal, Args)</code>。当 OTP 在停止应用程序时调用 <code>CallbackMod:stop(StartReturn)</code> 。 对于没有进程的应用程序（通常是代码库，例如 STDLIB），可以省略 <code>mod</code>。</p></li><li><p><strong><code>start_phases</code></strong> - 应用程序的启动阶段列表和相应的启动参数。如果存在此键，则应用程序主程序除了通常调用 <code>Module:start/2</code> 之外，还会为键 <code>start_phases</code> 定义的每个启动阶段调用 <code>Module:start_phase(Phase,Type,PhaseArgs)</code>。 只有在此扩展的启动过程之后，<code>application:start(Application)</code> 才会返回。</p><p>启动阶段可用于同步应用程序及其包含的应用程序的启动。 在这种情况下，必须按如下方式指定键 <code>mod</code></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>{mod, {application_starter,[Module,StartArgs]}}copy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后，应用程序主程序为主要应用程序调用 <code>Module:start/2</code>，然后为每个启动阶段（如为主要应用程序定义的那样）调用 <code>Module:start_phase/3</code>，包括主要应用程序及其每个包含的应用程序，并为启动阶段定义。</p><p>这意味着对于包含的应用程序，启动阶段的集合必须是为主要应用程序定义的阶段集合的子集。 有关更多信息，请参阅 <a href="https://erlang.org.cn/doc/system/applications" target="_blank" rel="noopener noreferrer">OTP 设计原则</a>。</p></li><li><p><strong><code>runtime_dependencies</code></strong> - 应用程序所依赖的应用程序版本列表。 这种应用程序版本的一个示例是 <code>&quot;kernel-3.0&quot;</code>。 指定为运行时依赖项的应用程序版本是最低要求。 也就是说，大于依赖项中指定的应用程序版本满足要求。 有关如何比较应用程序版本的信息，请参阅系统原则用户指南中的 <a href="https://erlang.org.cn/doc/system/versions" target="_blank" rel="noopener noreferrer">版本</a>部分。</p><p>请注意，应用程序版本指定了源代码版本。 另一个间接的要求是，安装的指定版本的二进制应用程序的构建应使其与系统的其余部分兼容。</p><p>某些依赖项可能仅在特定的运行时方案中是必需的。 当存在此类可选依赖项时，将在特定应用程序的相应“App”文档中指定和记录这些依赖项。</p></li></ul>`,10)]))}const k=i(e,[["render",p]]),d=JSON.parse('{"path":"/backend/erlang/h8hjjf1s/","title":"应用程序资源文件","lang":"zh-CN","frontmatter":{"title":"应用程序资源文件","createTime":"2025/03/23 14:37:13","permalink":"/backend/erlang/h8hjjf1s/"},"headers":[],"readingTime":{"minutes":4.99,"words":1498},"git":{"updatedTime":1744112181000,"contributors":[{"name":"舒永好","username":"舒永好","email":"shuyonghao@guoshenghuaxing.com","commits":1,"avatar":"https://gravatar.com/avatar/4b1c3f37ea707968be73c631a79de33afd360724ce87bf8f9dcacd67d14df92c?d=retro"},{"name":"syh","username":"syh","email":"syh@qq.com","commits":1,"avatar":"https://gravatar.com/avatar/060d67e779a1b0aeace68a2a010b367f852e56888393383ea27302df983f6814?d=retro"}]},"filePathRelative":"notes/backend/erlang/erlang_core/kernel/application_resource.md"}');export{k as comp,d as data};
